==========================================
SLURM_JOB_ID = 4793344
SLURM_JOB_NODELIST = b02-01
TMPDIR = /tmp/SLURM_4793344
==========================================
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: tensorflow==2.16.* in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.16.2)
Requirement already satisfied: imutils in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 2)) (0.5.4)
Requirement already satisfied: numpy in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 3)) (1.26.4)
Requirement already satisfied: pandas in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 4)) (2.3.3)
Requirement already satisfied: scikit-learn in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 5)) (1.7.2)
Requirement already satisfied: opencv-python in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 6)) (4.11.0.86)
Requirement already satisfied: matplotlib in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 7)) (3.10.7)
Requirement already satisfied: scipy in /home1/illyhoan/.local/lib/python3.12/site-packages (from -r requirements.txt (line 8)) (1.16.2)
Requirement already satisfied: absl-py>=1.0.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.3.1)
Requirement already satisfied: astunparse>=1.6.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (1.6.3)
Requirement already satisfied: flatbuffers>=23.5.26 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (25.9.23)
Requirement already satisfied: gast!=0.5.0,!=0.5.1,!=0.5.2,>=0.2.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.6.0)
Requirement already satisfied: google-pasta>=0.1.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.2.0)
Requirement already satisfied: h5py>=3.10.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.15.1)
Requirement already satisfied: libclang>=13.0.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (18.1.1)
Requirement already satisfied: ml-dtypes~=0.3.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.3.2)
Requirement already satisfied: opt-einsum>=2.3.2 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.4.0)
Requirement already satisfied: packaging in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (25.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,<5.0.0dev,>=3.20.3 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (4.25.8)
Requirement already satisfied: requests<3,>=2.21.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.32.5)
Requirement already satisfied: setuptools in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (80.9.0)
Requirement already satisfied: six>=1.12.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (1.17.0)
Requirement already satisfied: termcolor>=1.1.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.1.0)
Requirement already satisfied: typing-extensions>=3.6.6 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (4.15.0)
Requirement already satisfied: wrapt>=1.11.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.0.0)
Requirement already satisfied: grpcio<2.0,>=1.24.3 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (1.76.0)
Requirement already satisfied: tensorboard<2.17,>=2.16 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.16.2)
Requirement already satisfied: keras>=3.0.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.11.3)
Requirement already satisfied: nvidia-cublas-cu12==12.3.4.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.4.1)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.3.101 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.101)
Requirement already satisfied: nvidia-cuda-nvcc-cu12==12.3.107 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.107)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.3.107 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.107)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.3.101 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.101)
Requirement already satisfied: nvidia-cudnn-cu12==8.9.7.29 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (8.9.7.29)
Requirement already satisfied: nvidia-cufft-cu12==11.0.12.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (11.0.12.1)
Requirement already satisfied: nvidia-curand-cu12==10.3.4.107 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (10.3.4.107)
Requirement already satisfied: nvidia-cusolver-cu12==11.5.4.101 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (11.5.4.101)
Requirement already satisfied: nvidia-cusparse-cu12==12.2.0.103 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.2.0.103)
Requirement already satisfied: nvidia-nccl-cu12==2.19.3 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.19.3)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.3.101 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (12.3.101)
Requirement already satisfied: python-dateutil>=2.8.2 in /home1/illyhoan/.local/lib/python3.12/site-packages (from pandas->-r requirements.txt (line 4)) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from pandas->-r requirements.txt (line 4)) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /home1/illyhoan/.local/lib/python3.12/site-packages (from pandas->-r requirements.txt (line 4)) (2025.2)
Requirement already satisfied: joblib>=1.2.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from scikit-learn->-r requirements.txt (line 5)) (1.5.2)
Requirement already satisfied: threadpoolctl>=3.1.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from scikit-learn->-r requirements.txt (line 5)) (3.6.0)
Requirement already satisfied: contourpy>=1.0.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (1.3.3)
Requirement already satisfied: cycler>=0.10 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (4.60.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (1.4.9)
Requirement already satisfied: pillow>=8 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (12.0.0)
Requirement already satisfied: pyparsing>=3 in /home1/illyhoan/.local/lib/python3.12/site-packages (from matplotlib->-r requirements.txt (line 7)) (3.2.5)
Requirement already satisfied: wheel<1.0,>=0.23.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from astunparse>=1.6.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.45.1)
Requirement already satisfied: rich in /home1/illyhoan/.local/lib/python3.12/site-packages (from keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (14.2.0)
Requirement already satisfied: namex in /home1/illyhoan/.local/lib/python3.12/site-packages (from keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.1.0)
Requirement already satisfied: optree in /home1/illyhoan/.local/lib/python3.12/site-packages (from keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.17.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /home1/illyhoan/.local/lib/python3.12/site-packages (from requests<3,>=2.21.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /home1/illyhoan/.local/lib/python3.12/site-packages (from requests<3,>=2.21.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from requests<3,>=2.21.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.5.0)
Requirement already satisfied: certifi>=2017.4.17 in /home1/illyhoan/.local/lib/python3.12/site-packages (from requests<3,>=2.21.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2025.10.5)
Requirement already satisfied: markdown>=2.6.8 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorboard<2.17,>=2.16->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.9)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorboard<2.17,>=2.16->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from tensorboard<2.17,>=2.16->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.1.3)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from werkzeug>=1.0.1->tensorboard<2.17,>=2.16->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (3.0.3)
Requirement already satisfied: markdown-it-py>=2.2.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from rich->keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /home1/illyhoan/.local/lib/python3.12/site-packages (from rich->keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /home1/illyhoan/.local/lib/python3.12/site-packages (from markdown-it-py>=2.2.0->rich->keras>=3.0.0->tensorflow==2.16.*->tensorflow[and-cuda]==2.16.*->-r requirements.txt (line 1)) (0.1.2)

[notice] A new release of pip is available: 24.3.1 -> 25.3
[notice] To update, run: pip install --upgrade pip
2025-11-13 02:33:08.503519: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:479] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-13 02:33:09.126294: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:10575] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-13 02:33:09.129599: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1442] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-13 02:33:09.839067: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-13 02:33:12.272941: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-11-13 02:33:19.398259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1928] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 38482 MB memory:  -> device: 0, name: NVIDIA A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0
Found 3197 files belonging to 898 classes.
Downloading data from https://storage.googleapis.com/keras-applications/efficientnetb0_notop.h5
[1m       0/16705208[0m [37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 0s/step[1m 4202496/16705208[0m [32mâ”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [1m0s[0m 0us/step[1m10141696/16705208[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”â”â”â”â”â”â”â”[0m [1m0s[0m 0us/step[1m15941632/16705208[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37mâ”[0m [1m0s[0m 0us/step[1m16705208/16705208[0m [32mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[37m[0m [1m0s[0m 0us/step
Traceback (most recent call last):
  File "/home1/illyhoan/PokemonPals_DL/train.py", line 30, in <module>
    model = build_efficientnet(num_classes)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/illyhoan/PokemonPals_DL/models.py", line 53, in build_efficientnet
    base = tf.keras.applications.EfficientNetB0(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home1/illyhoan/.local/lib/python3.12/site-packages/keras/src/applications/efficientnet.py", line 571, in EfficientNetB0
    return EfficientNet(
           ^^^^^^^^^^^^^
  File "/home1/illyhoan/.local/lib/python3.12/site-packages/keras/src/applications/efficientnet.py", line 434, in EfficientNet
    model.load_weights(weights_path)
  File "/home1/illyhoan/.local/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home1/illyhoan/.local/lib/python3.12/site-packages/keras/src/legacy/saving/legacy_h5_format.py", line 452, in _set_weights
    raise ValueError(
ValueError: Shape mismatch in layer #1 (named stem_conv)for weight stem_conv/kernel. Weight expects shape (3, 3, 1, 32). Received saved weight with shape (3, 3, 3, 32)
